        // Skills Component
        const Skills = () => {
            const { user } = useAuth();
            const [skills, setSkills] = useState([]);
            const [employees, setEmployees] = useState([]);
            const [showForm, setShowForm] = useState(false);
            const [formData, setFormData] = useState({
                employee_id: '', skill_name: '', proficiency_level: 1, 
                category: '', target_level: 1
            });

            useEffect(() => {
                fetchSkills();
                if (user.role === 'manager') {
                    fetchEmployees();
                }
            }, []);

            const fetchSkills = async () => {
                try {
                    const response = await fetch('http://127.0.0.1:5000/api/skills', {
                        headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
                    });
                    if (response.ok) {
                        const data = await response.json();
                        setSkills(data);
                    }
                } catch (error) {
                    console.error('Error fetching skills:', error);
                }
            };

            const fetchEmployees = async () => {
                try {
                    const data = await apiCall('/employees');
                    setEmployees(data.filter(emp => emp.manager_id === user.id));
                } catch (error) {
                    console.error('Error fetching employees:', error);
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                try {
                    const skillData = { ...formData };
                    if (user.role !== 'manager') {
                        delete skillData.employee_id;
                    }
                    
                    const response = await fetch('http://127.0.0.1:5000/api/skills', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${localStorage.getItem('token')}`
                        },
                        body: JSON.stringify(skillData)
                    });
                    
                    if (response.ok) {
                        setShowForm(false);
                        setFormData({
                            employee_id: '', skill_name: '', proficiency_level: 1, 
                            category: '', target_level: 1
                        });
                        fetchSkills();
                    }
                } catch (error) {
                    console.error('Error saving skill:', error);
                }
            };

            return (
                <div className="max-w-6xl mx-auto py-6 px-4">
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-2xl font-bold text-gray-900">Skills Assessment</h2>
                        <button
                            onClick={() => setShowForm(true)}
                            className="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700"
                        >
                            Add Skill
                        </button>
                    </div>

                    {showForm && (
                        <div className="bg-white shadow rounded-lg p-6 mb-6">
                            <h3 className="text-lg font-semibold mb-4">Add New Skill</h3>
                            <form onSubmit={handleSubmit} className="grid grid-cols-2 gap-4">
                                {user.role === 'manager' && (
                                    <div className="col-span-2">
                                        <label className="block text-sm font-medium text-gray-700">Employee</label>
                                        <select
                                            value={formData.employee_id}
                                            onChange={(e) => setFormData({...formData, employee_id: e.target.value})}
                                            className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                            required
                                        >
                                            <option value="">Select Employee</option>
                                            {employees.map(emp => (
                                                <option key={emp.id} value={emp.id}>
                                                    {emp.first_name} {emp.last_name}
                                                </option>
                                            ))}
                                        </select>
                                    </div>
                                )}
                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Skill Name</label>
                                    <input
                                        type="text"
                                        value={formData.skill_name}
                                        onChange={(e) => setFormData({...formData, skill_name: e.target.value})}
                                        className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                        required
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Category</label>
                                    <select
                                        value={formData.category}
                                        onChange={(e) => setFormData({...formData, category: e.target.value})}
                                        className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                    >
                                        <option value="">Select Category</option>
                                        <option value="Technical">Technical</option>
                                        <option value="Soft Skills">Soft Skills</option>
                                        <option value="Leadership">Leadership</option>
                                        <option value="Communication">Communication</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Current Level (1-5)</label>
                                    <select
                                        value={formData.proficiency_level}
                                        onChange={(e) => setFormData({...formData, proficiency_level: parseInt(e.target.value)})}
                                        className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                    >
                                        <option value={1}>1 - Beginner</option>
                                        <option value={2}>2 - Basic</option>
                                        <option value={3}>3 - Intermediate</option>
                                        <option value={4}>4 - Advanced</option>
                                        <option value={5}>5 - Expert</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Target Level (1-5)</label>
                                    <select
                                        value={formData.target_level}
                                        onChange={(e) => setFormData({...formData, target_level: parseInt(e.target.value)})}
                                        className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                    >
                                        <option value={1}>1 - Beginner</option>
                                        <option value={2}>2 - Basic</option>
                                        <option value={3}>3 - Intermediate</option>
                                        <option value={4}>4 - Advanced</option>
                                        <option value={5}>5 - Expert</option>
                                    </select>
                                </div>
                                <div className="col-span-2 flex justify-end space-x-3">
                                    <button
                                        type="button"
                                        onClick={() => setShowForm(false)}
                                        className="bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        type="submit"
                                        className="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700"
                                    >
                                        Add Skill
                                    </button>
                                </div>
                            </form>
                        </div>
                    )}

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {skills.map(skill => (
                            <div key={skill.id} className="bg-white shadow rounded-lg p-6">
                                <div className="flex justify-between items-start mb-3">
                                    <h3 className="text-lg font-semibold text-gray-900">{skill.skill_name}</h3>
                                    {skill.category && (
                                        <span className="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">
                                            {skill.category}
                                        </span>
                                    )}
                                </div>
                                
                                <div className="space-y-3">
                                    <div>
                                        <div className="flex justify-between text-sm text-gray-600 mb-1">
                                            <span>Current Level</span>
                                            <span>{skill.proficiency_level}/5</span>
                                        </div>
                                        <div className="w-full bg-gray-200 rounded-full h-2">
                                            <div
                                                className="bg-blue-500 h-2 rounded-full"
                                                style={{ width: `${(skill.proficiency_level / 5) * 100}%` }}
                                            />
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <div className="flex justify-between text-sm text-gray-600 mb-1">
                                            <span>Target Level</span>
                                            <span>{skill.target_level}/5</span>
                                        </div>
                                        <div className="w-full bg-gray-200 rounded-full h-2">
                                            <div
                                                className="bg-green-500 h-2 rounded-full"
                                                style={{ width: `${(skill.target_level / 5) * 100}%` }}
                                            />
                                        </div>
                                    </div>
                                    
                                    {skill.target_level > skill.proficiency_level && (
                                        <div className="text-sm text-orange-600 font-medium">
                                            Gap: {skill.target_level - skill.proficiency_level} levels
                                        </div>
                                    )}
                                    
                                    {skill.last_assessed && (
                                        <div className="text-xs text-gray-500">
                                            Last assessed: {new Date(skill.last_assessed).toLocaleDateString()}
                                        </div>
                                    )}
                                </div>
                            </div>
                        ))}
                    </div>

                    {skills.length === 0 && (
                        <div className="text-center py-12">
                            <p className="text-gray-500">No skills recorded. Add your first skill assessment!</p>
                        </div>
                    )}
                </div>
            );
        };

        // Reviews Component
        const Reviews = () => {
            const { user } = useAuth();
            const [reviews, setReviews] = useState([]);
            const [employees, setEmployees] = useState([]);
            const [showForm, setShowForm] = useState(false);
            const [formData, setFormData] = useState({
                reviewee_id: '', review_type: 'self', review_period: '',
                overall_rating: 1, technical_skills: 1, communication: 1,
                leadership: 1, teamwork: 1, comments: '', strengths: '',
                areas_for_improvement: ''
            });

            useEffect(() => {
                fetchReviews();
                fetchEmployees();
            }, []);

            const fetchReviews = async () => {
                try {
                    const data = await apiCall('/reviews');
                    setReviews(data);
                } catch (error) {
                    console.error('Error fetching reviews:', error);
                }
            };

            const fetchEmployees = async () => {
                try {
                    const data = await apiCall('/employees');
                    setEmployees(data);
                } catch (error) {
                    console.error('Error fetching employees:', error);
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                try {
                    await apiCall('/reviews', {
                        method: 'POST',
                        body: JSON.stringify(formData)
                    });
                    setShowForm(false);
                    setFormData({
                        reviewee_id: '', review_type: 'self', review_period: '',
                        overall_rating: 1, technical_skills: 1, communication: 1,
                        leadership: 1, teamwork: 1, comments: '', strengths: '',
                        areas_for_improvement: ''
                    });
                    fetchReviews();
                } catch (error) {
                    console.error('Error saving review:', error);
                }
            };

            const handleSubmitReview = async (reviewId) => {
                try {
                    await apiCall(`/reviews/${reviewId}/submit`, { method: 'POST' });
                    fetchReviews();
                } catch (error) {
                    console.error('Error submitting review:', error);
                }
            };

            return (
                <div className="max-w-6xl mx-auto py-6 px-4">
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-2xl font-bold text-gray-900">Performance Reviews</h2>
                        <button
                            onClick={() => setShowForm(true)}
                            className="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700"
                        >
                            Create Review
                        </button>
                    </div>

                    {showForm && (
                        <div className="bg-white shadow rounded-lg p-6 mb-6">
                            <h3 className="text-lg font-semibold mb-4">Create Performance Review</h3>
                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700">Reviewee</label>
                                        <select
                                            value={formData.reviewee_id}
                                            onChange={(e) => setFormData({...formData, reviewee_id: e.target.value})}
                                            className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                            required
                                        >
                                            <option value="">Select Employee</option>
                                            {employees.map(emp => (
                                                <option key={emp.id} value={emp.id}>
                                                    {emp.first_name} {emp.last_name}
                                                </option>
                                            ))}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700">Review Type</label>
                                        <select
                                            value={formData.review_type}
                                            onChange={(e) => setFormData({...formData, review_type: e.target.value})}
                                            className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                        >
                                            <option value="self">Self Review</option>
                                            <option value="peer">Peer Review</option>
                                            <option value="manager">Manager Review</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Review Period</label>
                                    <input
                                        type="text"
                                        value={formData.review_period}
                                        onChange={(e) => setFormData({...formData, review_period: e.target.value})}
                                        className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                        placeholder="e.g., Q1 2024"
                                    />
                                </div>

                                <div className="grid grid-cols-5 gap-4">
                                    {['overall_rating', 'technical_skills', 'communication', 'leadership', 'teamwork'].map(field => (
                                        <div key={field}>
                                            <label className="block text-sm font-medium text-gray-700 capitalize">
                                                {field.replace('_', ' ')}
                                            </label>
                                            <select
                                                value={formData[field]}
                                                onChange={(e) => setFormData({...formData, [field]: parseInt(e.target.value)})}
                                                className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                            >
                                                <option value={1}>1</option>
                                                <option value={2}>2</option>
                                                <option value={3}>3</option>
                                                <option value={4}>4</option>
                                                <option value={5}>5</option>
                                            </select>
                                        </div>
                                    ))}
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Comments</label>
                                    <textarea
                                        value={formData.comments}
                                        onChange={(e) => setFormData({...formData, comments: e.target.value})}
                                        className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                        rows="3"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Strengths</label>
                                    <textarea
                                        value={formData.strengths}
                                        onChange={(e) => setFormData({...formData, strengths: e.target.value})}
                                        className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                        rows="2"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Areas for Improvement</label>
                                    <textarea
                                        value={formData.areas_for_improvement}
                                        onChange={(e) => setFormData({...formData, areas_for_improvement: e.target.value})}
                                        className="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"
                                        rows="2"
                                    />
                                </div>

                                <div className="flex justify-end space-x-3">
                                    <button
                                        type="button"
                                        onClick={() => setShowForm(false)}
                                        className="bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        type="submit"
                                        className="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700"
                                    >
                                        Create Review
                                    </button>
                                </div>
                            </form>
                        </div>
                    )}

                    <div className="space-y-6">
                        {reviews.map(review => (
                            <div key={review.id} className="bg-white shadow rounded-lg p-6">
                                <div className="flex justify-between items-start mb-4">
                                    <div>
                                        <h3 className="text-lg font-semibold text-gray-900">
                                            {review.reviewee_name} - {review.review_type} Review
                                        </h3>
                                        <p className="text-sm text-gray-600">
                                            By: {review.reviewer_name} | Period: {review.review_period}
                                        </p>
                                    </div>
                                    <div className="flex items-center space-x-2">
                                        <span className={`px-2 py-1 text-xs rounded-full ${
                                            review.status === 'completed' ? 'bg-green-100 text-green-800' :
                                            review.status === 'submitted' ? 'bg-blue-100 text-blue-800' :
                                            'bg-gray-100 text-gray-800'
                                        }`}>
                                            {review.status}
                                        </span>
                                        {review.status === 'draft' && (
                                            <button
                                                onClick={() => handleSubmitReview(review.id)}
                                                className="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"
                                            >
                                                Submit
                                            </button>
                                        )}
                                    </div>
                                </div>

                                <div className="grid grid-cols-5 gap-4 mb-4">
                                    <div className="text-center">
                                        <div className="text-2xl font-bold text-blue-600">{review.overall_rating}</div>
                                        <div className="text-xs text-gray-600">Overall</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-2xl font-bold text-green-600">{review.technical_skills}</div>
                                        <div className="text-xs text-gray-600">Technical</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-2xl font-bold text-purple-600">{review.communication}</div>
                                        <div className="text-xs text-gray-600">Communication</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-2xl font-bold text-orange-600">{review.leadership}</div>
                                        <div className="text-xs text-gray-600">Leadership</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-2xl font-bold text-red-600">{review.teamwork}</div>
                                        <div className="text-xs text-gray-600">Teamwork</div>
                                    </div>
                                </div>

                                {review.comments && (
                                    <div className="mb-3">
                                        <h4 className="font-medium text-gray-900 mb-1">Comments</h4>
                                        <p className="text-gray-700 text-sm">{review.comments}</p>
                                    </div>
                                )}

                                <div className="grid grid-cols-2 gap-4">
                                    {review.strengths && (
                                        <div>
                                            <h4 className="font-medium text-gray-900 mb-1">Strengths</h4>
                                            <p className="text-gray-700 text-sm">{review.strengths}</p>
                                        </div>
                                    )}
                                    {review.areas_for_improvement && (
                                        <div>
                                            <h4 className="font-medium text-gray-900 mb-1">Areas for Improvement</h4>
                                            <p className="text-gray-700 text-sm">{review.areas_for_improvement}</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        ))}
                    </div>

                    {reviews.length === 0 && (
                        <div className="text-center py-12">
                            <p className="text-gray-500">No reviews found. Create your first performance review!</p>
                        </div>
                    )}
                </div>
            );
        };